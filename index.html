<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - Identität & Fortschritt</title>
    <style>
        /* BASIS-LAYOUT */
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }

        /* ANIMATIONEN */
        @keyframes signalBlink {
            0% { box-shadow: 0 0 5px #fff; opacity: 0.8; }
            50% { box-shadow: 0 0 25px #fff, 0 0 35px #003d8f; opacity: 1; transform: scale(1.05); }
            100% { box-shadow: 0 0 5px #fff; opacity: 0.8; }
        }
        @keyframes eliteBlink {
            0% { background-color: #000; box-shadow: 0 0 5px #333; }
            50% { background-color: #444; box-shadow: 0 0 20px #666, inset 0 0 10px #000; transform: scale(1.1); }
            100% { background-color: #000; box-shadow: 0 0 5px #333; }
        }

        .signal-aktiv { animation: signalBlink 1.0s infinite ease-in-out !important; border: 2px solid #fff !important; cursor: pointer; }
        .elite-aktiv { animation: eliteBlink 2s infinite ease-in-out !important; border: 2px solid #ffd700 !important; cursor: pointer; }

        /* HEADER & LOGO */
        .dashboard-header { width: 100%; position: absolute; top: 3%; display: flex; justify-content: flex-start; padding: 0 2%; box-sizing: border-box; z-index: 20; }
        .logo-ring { width: 110px; height: 110px; border: 3px solid #fff; background-color: #003d8f; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .logo-mm { font-size: 2rem; font-weight: 900; line-height: 0.8; }
        .logo-community { font-size: 0.6rem; letter-spacing: 1.5px; text-transform: uppercase; font-weight: bold; }

        /* GRID DASHBOARD */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); grid-auto-flow: column; gap: 10px; width: 95%; max-width: 1450px; margin-top: 150px; border: 3px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box, .fundament-box { display: flex; border: 2px solid #003d8f; background-color: #000; min-height: 58px; position: relative; overflow: hidden; }
        .num { width: 38px; display: flex; align-items: center; justify-content: center; background-color: #003d8f; font-weight: bold; flex-shrink: 0; font-size: 0.85rem; }
        .text { padding: 4px 8px; text-transform: uppercase; font-size: 0.6rem; display: flex; align-items: center; cursor: pointer; flex-grow: 1; font-weight: 600; }

        /* TAFEL & EBENEN */
        #page-skelett { display: none; width: 100%; flex-direction: column; align-items: center; height: 100vh; }
        .tafel-layout { display: flex; align-items: center; justify-content: center; width: 100%; position: relative; height: 26vh; margin-top: 20px; }
        .info-section-ebene { width: 80% !important; height: 100%; border: 2px solid #003d8f; background-color: #000; position: relative; overflow: hidden; display: flex; justify-content: center; align-items: center; }

        /* BUTTONS */
        .buttons-links, .buttons-rechts { display: flex; flex-direction: column; gap: 15px; padding: 0 20px; }
        .oval-side { width: 45px; height: 22px; border-radius: 12px; border: 1px solid #fff; opacity: 0.8; }
        .ov-schwarz { background: #000; border: 1.5px solid #003d8f; }
        .ov-grun { background: #00ff00; } .ov-blau { background: #0000ff; } .ov-rot { background: #ff0000; } .ov-pink { background: #ff00ff; } .ov-gelb { background: #ffff00; }

        /* NAV */
        .bottom-nav { display: flex; justify-content: space-between; width: 100%; padding: 10px 20px; position: fixed; bottom: 0; background: #000; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        .dot { width: 10px; height: 10px; background: #444; border-radius: 50%; margin: 0 4px; }
        .dot.active { background: #ffd700; }

        #login-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:center; }
        
        /* CHAT */
        #chat-area { width: 90%; flex-grow: 1; display: none; flex-direction: column; margin-bottom: 70px; }
        .chat-msgs { flex: 1; overflow-y: auto; padding: 10px; border: 1px solid #003d8f; margin-bottom: 5px; }

        /* STATUSFARBEN GRID */
        .num-neutral { background-color: #003d8f !important; }
        .num-gelesen { background-color: #ffd700 !important; color: #000 !important; }
        .num-fertig { background-color: #00ff00 !important; color: #000 !important; }
    </style>
</head>
<body onload="initSystem()">

    <div id="login-overlay">
        <div class="logo-ring" style="margin-bottom:20px;"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div>
        <h2 style="color:#003d8f;">IDENTITÄTS-CHECK</h2>
        <input type="text" id="user-name-input" placeholder="Dein Schöpfer-Name" style="padding:15px; width:250px; border:1px solid #003d8f; background:#111; color:#fff; text-align:center; font-size:1.2rem;">
        <button onclick="anmeldung(document.getElementById('user-name-input').value)" style="margin-top:20px; padding:10px 40px; background:#ffd700; color:#000; border:none; font-weight:bold; cursor:pointer;">BETRETEN</button>
    </div>

    <div id="dashboard" style="display:none; width: 100%; flex-direction: column; align-items: center;">
        <div class="dashboard-header">
            <div class="logo-ring" ondblclick="adminUnlock()"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div>
            <div id="welcome-msg" style="margin-left: 20px; align-self: center; font-weight: bold; color: #ffd700;"></div>
        </div>
        <div class="grid" id="main-grid"></div>
    </div>

    <div id="page-skelett">
        <h1 id="info-titel" class="page-title-white"></h1>
        <div class="tafel-layout">
            <div class="buttons-links">
                <div class="oval-side ov-schwarz" id="sig-l1"></div>
                <div class="oval-side ov-rot" id="sig-l4" onclick="portalZuEbene4()"></div>
            </div>
            <div class="info-section-ebene">
                <div id="counter-box" style="color: red; font-weight: 900;">STILLE MILLION: 842.336</div>
            </div>
            <div class="buttons-rechts">
                <div class="oval-side ov-gelb" id="sig-r4" onclick="portalZuEbene3()"></div>
            </div>
        </div>

        <p id="main-text" style="width: 80%; text-align: justify; margin-top: 20px;"></p>

        <div id="chat-area">
            <div class="chat-msgs" id="chat-box"></div>
            <input type="text" id="chat-input" placeholder="Nachricht..." style="width:100%; padding:10px; background:#111; border:1px solid #003d8f; color:#fff;">
        </div>
    </div>

    <div class="bottom-nav" id="nav-bar" style="display:none;">
        <button id="btn-back" class="nav-btn" onclick="showDashboard()">← Dashboard</button>
        <div id="dot-holder" style="display:flex; align-items:center;"></div>
        <button id="btn-next" class="nav-btn" onclick="nextPage()">Weiter →</button>
    </div>

<script>
    const DB_KEY = "MM_COMMUNITY_USER_DATA";
    const themen = ["Recht auf Gefühls Forderung", "Wie werde ich Mensch", "Glaube an Friede", "Programm für Bürgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend und Tradition", "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber für Pensionisten", "Sozialgefallen und Widerkehr", "Nachbarschaft und Gemeinschaft", "Mensch und Technik", "Die Brücke"];

    let userSession = {
        username: "",
        isLoggedIn: false,
        sektorZeiten: Array(20).fill(0),
        interaktionsZaehler: Array(20).fill(0),
        geleseneThemen: []
    };

    let ebene = 1, tId = 0, zaehlerInterval = null;

    // --- KERN-LOGIK: IDENTITÄT ---
    function initSystem() {
        const savedData = localStorage.getItem(DB_KEY);
        if (savedData) {
            userSession = JSON.parse(savedData);
            if (userSession.isLoggedIn) ladenUndStarten();
        }
    }

    function anmeldung(name) {
        if (name.trim().length < 3) return alert("Identität zu kurz (min. 3 Zeichen).");
        userSession.username = name;
        userSession.isLoggedIn = true;
        speichereDaten();
        ladenUndStarten();
    }

    function ladenUndStarten() {
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('dashboard').style.display = 'flex';
        document.getElementById('nav-bar').style.display = 'flex';
        document.getElementById('welcome-msg').innerText = "MENSCH: " + userSession.username.toUpperCase();
        baueGrid();
        baueDots();
    }

    function speichereDaten() {
        localStorage.setItem(DB_KEY, JSON.stringify(userSession));
    }

    // --- UI LOGIK ---
    function baueGrid() {
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        themen.forEach((t, i) => {
            let statusClass = "num-neutral";
            if (userSession.interaktionsZaehler[i] >= 20) statusClass = "num-fertig";
            else if (userSession.geleseneThemen.includes(i)) statusClass = "num-gelesen";

            grid.innerHTML += `
                <div class="box" id="box-${i}">
                    <div class="num ${statusClass}" id="num-${i}">${i+1}</div>
                    <div class="text" onclick="showInfo(${i})">${t}</div>
                </div>`;
        });
    }

    function baueDots() {
        const holder = document.getElementById('dot-holder');
        holder.innerHTML = "";
        for(let i=1; i<=7; i++) holder.innerHTML += `<div id="dot${i}" class="dot ${i===ebene?'active':''}"></div>`;
    }

    function showInfo(id) {
        tId = id; ebene = 2;
        if(!userSession.geleseneThemen.includes(id)) userSession.geleseneThemen.push(id);
        speichereDaten();
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('page-skelett').style.display = 'flex';
        updateUI();
    }

    function updateUI() {
        document.getElementById('info-titel').innerText = themen[tId];
        document.getElementById('main-text').innerText = "Inhalt wird geladen für: " + themen[tId];
        document.getElementById('chat-area').style.display = (ebene === 3) ? 'flex' : 'none';
        
        // Backstage Zähler
        if(ebene === 4) starteZaehler(); else stoppeZaehler();
        
        // Signal-Lichter
        document.getElementById('sig-r4').classList.toggle('signal-aktiv', (ebene === 2 && userSession.geleseneThemen.length === 20));
        
        baueDots();
        baueGrid();
    }

    function starteZaehler() {
        stoppeZaehler();
        zaehlerInterval = setInterval(() => {
            userSession.sektorZeiten[tId]++;
            if(userSession.sektorZeiten[tId] % 10 === 0) speichereDaten(); // Alle 10 Sek Autosave
            pruefeEliteStatus();
        }, 1000);
    }
    function stoppeZaehler() { clearInterval(zaehlerInterval); }

    function pruefeEliteStatus() {
        const sigL1 = document.getElementById('sig-l1');
        const alleMinutenOk = userSession.sektorZeiten.every(z => z >= 1800);
        if(alleMinutenOk) {
            sigL1.className = "oval-side elite-aktiv";
            sigL1.onclick = () => alert("KANDIDATUR FREIGESCHALTET!");
        }
    }

    function portalZuEbene3() { if(ebene === 2) { ebene = 3; updateUI(); } }
    function portalZuEbene4() { if(ebene === 3) { ebene = 4; updateUI(); } }
    function showDashboard() { ebene = 1; stoppeZaehler(); document.getElementById('page-skelett').style.display = 'none'; document.getElementById('dashboard').style.display = 'flex'; updateUI(); }
    
    function adminUnlock() {
        userSession.geleseneThemen = [...Array(20).keys()];
        userSession.interaktionsZaehler = Array(20).fill(20);
        speichereDaten();
        baueGrid();
        alert("ADMIN: Alle Sektoren freigeschaltet.");
    }
</script>
</body>
</html>
