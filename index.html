<!DOCTYPE html>
<html lang="de">
<head>
    <script src='https://8x8.vc/vpaas-magic-cookie-39f826359e1345d38f8304910901e855/external_api.js'></script>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - Admin Modus</title>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <style>
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        
        /* HEADER */
        .dashboard-header { width: 100%; padding: 20px; box-sizing: border-box; z-index: 20; display: flex; justify-content: flex-start; }
        .logo-ring { width: 100px; height: 100px; border: 3px solid #fff; background-color: #003d8f; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .logo-mm { font-size: 1.8rem; font-weight: 900; line-height: 0.8; }
        .logo-community { font-size: 0.5rem; letter-spacing: 1px; text-transform: uppercase; }

        /* DASHBOARD */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 95%; max-width: 1400px; margin-top: 20px; border: 2px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box { display: flex; border: 1px solid #003d8f; background-color: #000; min-height: 50px; }
        .num { width: 35px; display: flex; align-items: center; justify-content: center; background-color: #003d8f; font-weight: bold; }
        .num-fertig { background-color: #00ff00 !important; color: #000 !important; }
        .text { padding: 5px 10px; font-size: 0.7rem; text-transform: uppercase; cursor: pointer; flex-grow: 1; display: flex; align-items: center; }

        /* PAGE SKELETT */
        #page-skelett { display: none; width: 100%; flex-direction: column; align-items: center; height: 100vh; overflow-y: auto; padding-bottom: 100px; }
        .tafel-layout { width: 90%; height: 20vh; border: 2px solid #003d8f; position: relative; margin: 10px 0; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .werbe-bild-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0.4; }
        
        #main-text-area { width: 85%; text-align: justify; color: #ccc; font-size: 1.2rem; line-height: 1.6; margin-top: 20px; }
        
        /* CHAT */
        #chat-area { width: 90%; max-width: 800px; flex-direction: column; margin-top: 20px; }
        .chat-msgs { height: 300px; border: 1px solid #333; overflow-y: auto; padding: 15px; background: #050505; margin-bottom: 10px; }

        /* EBENE 4 & SCHUBLADEN */
        #drawer-ebene4 { width: 90%; flex-direction: column; gap: 20px; margin-top: 20px; }
        .schublade { border: 1px solid #003d8f; margin-bottom: 10px; background: #050505; width: 100%; }
        .schublade-header { padding: 15px; background: #001a3d; cursor: pointer; display: flex; justify-content: space-between; font-weight: bold; }
        .schublade-content { display: none; padding: 20px; border-top: 1px solid #003d8f; }
        .schublade.open > .schublade-content { display: block; }

        /* NAV */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: #000; display: flex; justify-content: space-between; padding: 15px; border-top: 1px solid #333; z-index: 100; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        .dot { width: 10px; height: 10px; background: #444; border-radius: 50%; margin: 0 5px; }
        .dot.active { background: #ffd700; }
    </style>
</head>
<body>

<div id="dashboard" style="width:100%; display:flex; flex-direction:column; align-items:center;">
    <div class="dashboard-header">
        <div class="logo-ring" ondblclick="adminUnlock()"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div>
    </div>
    <div style="text-align:center;">
        <h1>DAS WAS & WARUM</h1>
        <h2 style="color:#003d8f;">DIE STILLE MILLION</h2>
    </div>
    <div class="grid" id="main-grid"></div>
</div>

<div id="page-skelett">
    <div class="tafel-layout">
        <div class="werbe-bild-bg" id="werbe-bg"></div>
        <div style="z-index:10; text-align:center;">
            <div style="font-size:0.5rem;">STILLE MILLION</div>
            <div class="counter-value" style="font-size:1.5rem; font-weight:bold;">842.336</div>
        </div>
    </div>
    
    <h1 id="info-titel"></h1>
    <div id="ebene4-title-red" style="color:red; display:none;">KONFERENZ MODUS</div>

    <div id="main-text-area">
        <p id="main-text"></p>
    </div>

    <div id="chat-area" style="display:none;">
        <div class="chat-msgs" id="chat-box"></div>
        <div style="display:flex; gap:10px;">
            <input type="text" id="chat-input" style="flex:1; background:#111; border:1px solid #003d8f; color:#fff; padding:10px;">
            <button onclick="registriereSenden()" style="background:#003d8f; color:#fff; border:none; padding:0 20px;">SENDEN</button>
        </div>
    </div>

    <div id="drawer-ebene4" style="display:none;">
        <div id="jitsi-container" style="width:100%; height:400px; border:2px solid red;"></div>
        <div id="sektoren-schubladen"></div>
    </div>
</div>

<div class="bottom-nav">
    <button class="nav-btn" onclick="showDashboard()">‚Üê Dashboard</button>
    <div id="dot-holder" style="display:flex; align-items:center;"></div>
    <button class="nav-btn" onclick="nextPage()">Weiter ‚Üí</button>
</div>

<script>
    const themen = ["Recht auf Gef√ºhlsvorderung oder KI", "Wie werde ich Mensch", "Glaube an Friede", "Programm f√ºr B√ºrgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber f√ºr Pensionisten", "Nachbarschaft und Gemeinschaft", "Sozialgefallen und Widerkehr", "Alleinerziehend & Kind", "Die Br√ºcke"];
    
    // (Inhalte hier gek√ºrzt f√ºr √úbersicht, du hast die vollen Texte ja)
    const DASHBOARD_TRUTH = {
        1: { title: "Recht auf Gef√ºhlsvorderung oder KI", content: "Die digitale Welt hat eine Schicht aus Taubheit..." },
        // ... stell sicher, dass alle 1-20 hier drin sind
    };

    let userBackstage = JSON.parse(localStorage.getItem('mm_user_data')) || { sektorNotizen: {}, besuchteSektoren: [], isVerifiziert: false };
    let ebene = 1, tId = 0, aktuellesThema = "";
    let jitsiApi = null, aktuellerChannel = null;
    const ably = new Ably.Realtime('IO8wIA.C7HVjQ:SdzgpyD0_ilg8UOO-mXm94ro0VtTUSao8HUMoW7538sA');
    const meinTabId = Math.random().toString(36).substring(7);

    function initApp() {
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        themen.forEach((thema, index) => {
            const box = document.createElement('div'); box.className = 'box';
            const istBesucht = userBackstage.besuchteSektoren.includes(index);
            box.innerHTML = `<div class="num ${istBesucht?'num-fertig':''}">${index+1}</div><div class="text" onclick="checkAccess(${index}, '${thema}')">${thema}</div>`;
            grid.appendChild(box);
        });

        const dots = document.getElementById('dot-holder');
        dots.innerHTML = "";
        for(let i=1; i<=4; i++) dots.innerHTML += `<div id="dot${i}" class="dot ${i===1?'active':''}"></div>`;
        
        // Sektoren Zentrale f√ºr Ebene 4 bauen
        const drawerArea = document.getElementById('sektoren-schubladen');
        drawerArea.innerHTML = `
            <div class="schublade" id="master-archiv">
                <div class="schublade-header" onclick="toggleDrawer('master')" style="background:#ffd700; color:#000;">üìÇ SEKTOREN-ZENTRALE <span id="arrow-master">‚ñº</span></div>
                <div id="inneres-archiv" class="schublade-content" style="background:#000;"></div>
            </div>`;
        const archiv = document.getElementById('inneres-archiv');
        for(let i=1; i<=20; i++) {
            archiv.innerHTML += `
                <div class="schublade" id="drawer-${i}">
                    <div class="schublade-header" onclick="toggleDrawer(${i})" style="font-size:0.8rem;">SEKTOR ${i} <span id="arrow-${i}">‚ñº</span></div>
                    <div class="schublade-content">
                        <p style="font-size:0.9rem;">${DASHBOARD_TRUTH[i]?.title || '...'}</p>
                        <textarea id="note-${i}" style="width:100%; background:#111; color:#fff;">${userBackstage.sektorNotizen[i] || ''}</textarea>
                        <button onclick="saveNote(${i})" style="background:#ffd700; border:none; margin-top:5px;">SICHERN</button>
                    </div>
                </div>`;
        }
    }

    function checkAccess(id, t) {
        tId = id; aktuellesThema = t;
        if(!userBackstage.besuchteSektoren.includes(id)) { userBackstage.besuchteSektoren.push(id); saveToStorage(); }
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('page-skelett').style.display = 'flex';
        document.getElementById('info-titel').innerText = t;
        document.getElementById('main-text').innerText = DASHBOARD_TRUTH[id+1]?.content || "Inhalt folgt...";
        setEbene(2);
        verbindeMitSektorChat(id);
    }

    function setEbene(n) {
        ebene = n;
        document.getElementById('main-text-area').style.display = (n === 2) ? 'block' : 'none';
        document.getElementById('chat-area').style.display = (n === 3) ? 'flex' : 'none';
        document.getElementById('drawer-ebene4').style.display = (n === 4) ? 'flex' : 'none';
        document.getElementById('ebene4-title-red').style.display = (n === 4) ? 'block' : 'none';
        for(let i=1; i<=4; i++) document.getElementById('dot'+i).classList.toggle('active', i===n);
        if(n === 4) startJitsi();
    }

    function toggleDrawer(id) {
        const el = (id === 'master') ? document.getElementById('master-archiv') : document.getElementById('drawer-'+id);
        const arrow = (id === 'master') ? document.getElementById('arrow-master') : document.getElementById('arrow-'+id);
        el.classList.toggle('open');
        arrow.innerText = el.classList.contains('open') ? '‚ñ≤' : '‚ñº';
    }

    function showDashboard() { document.getElementById('page-skelett').style.display = 'none'; document.getElementById('dashboard').style.display = 'flex'; if(jitsiApi) jitsiApi.dispose(); }
    function nextPage() { if(ebene < 4) setEbene(ebene + 1); }
    function saveToStorage() { localStorage.setItem('mm_user_data', JSON.stringify(userBackstage)); }
    function saveNote(i) { userBackstage.sektorNotizen[i] = document.getElementById('note-'+i).value; saveToStorage(); alert("Gesichert!"); }

    function startJitsi() {
        if(!userBackstage.isVerifiziert) { alert("Kein Zutritt!"); setEbene(2); return; }
        if(jitsiApi) jitsiApi.dispose();
        jitsiApi = new JitsiMeetExternalAPI("8x8.vc", { roomName: "MM-Sektor-"+tId, parentNode: document.querySelector('#jitsi-container') });
    }

    function adminUnlock() { if(prompt("Code?") === "frosch2026") { userBackstage.isVerifiziert = true; saveToStorage(); location.reload(); } }
    
    window.onload = initApp;
    // ... (verbindeMitSektorChat und registriereSenden bleiben gleich)
</script>
</body>
</html>
 
