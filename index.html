<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>M&M - Neustart</title>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; text-align: center; }
        
        /* Dashboard Grid */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; padding: 20px; max-width: 1000px; margin: auto; }
        .box { border: 1px solid #003d8f; padding: 20px; cursor: pointer; background: #050505; }
        .box:hover { border-color: #ffd700; }
        .box.locked { opacity: 0.3; cursor: not-allowed; }
        .box.read { background: #003d8f; }

        /* Sektor Ansicht */
        #sektor-view { display: none; padding: 50px; }
        .back-btn { background: #ffd700; padding: 10px 20px; cursor: pointer; border: none; font-weight: bold; }
        
        #chat-box { border: 1px solid #333; height: 200px; overflow-y: auto; margin: 20px auto; max-width: 600px; padding: 10px; text-align: left; }
    </style>
</head>
<body>

    <div id="dashboard">
        <h1>M&M COMMUNITY</h1>
        <div class="grid" id="main-grid"></div>
    </div>

    <div id="sektor-view">
        <button class="back-btn" onclick="showDashboard()">← ZURÜCK</button>
        <h2 id="sektor-titel">Sektor Titel</h2>
        <div id="chat-box"></div>
        <input type="text" id="chat-in" placeholder="Nachricht...">
        <button onclick="sendMsg()">SENDEN</button>
    </div>

<script>
   const themen = [
    "Recht auf Gefühls Forderung", "Wie werde ich Mensch", "Glaube an Friede", 
    "Programm für Bürgerliche Rechte", "Moralische Pflicht und Verantwortung", 
    "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", 
    "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", 
    "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", 
    "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", 
    "Ratgeber für Pensionisten", "Sozialgefallen und Widerkehr", 
    "Nachbarschaft und Gemeinschaft", "Mensch und Technik", "Die Brücke"
];

    // Ably Setup
    const ably = new Ably.Realtime('8_Z6_g.x8999g:pYlD6QyG-A_v9H_A');
    let channel = null;

    // Grid bauen
    function buildGrid() {
        const container = document.getElementById('main-grid');
        container.innerHTML = "";
        themen.forEach((t, i) => {
            const isLocked = i > 0 && !gelesene.has(i-1);
            const statusClass = isLocked ? "locked" : (gelesene.has(i) ? "read" : "");
            
            container.innerHTML += `
                <div class="box ${statusClass}" onclick="openSektor(${i})">
                    <strong>${i+1}</strong><br><small>${t}</small>
                </div>`;
        });
    }

    function openSektor(id) {
        if (id > 0 && !gelesene.has(id-1)) return alert("Reihenfolge einhalten!");
        
        aktuellerSektor = id;
        gelesene.add(id);
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('sektor-view').style.display = 'block';
        document.getElementById('sektor-titel').innerText = themen[id];
        
        // Chat verbinden
        if(channel) channel.unsubscribe();
        channel = ably.channels.get('mm-' + id);
        channel.subscribe(msg => {
            document.getElementById('chat-box').innerHTML += `<div>Partner: ${msg.data}</div>`;
        });
        
        buildGrid();
    }

    function showDashboard() {
        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('sektor-view').style.display = 'none';
    }

    function sendMsg() {
        const inp = document.getElementById('chat-in');
        channel.publish('msg', inp.value);
        document.getElementById('chat-box').innerHTML += `<div>Du: ${inp.value}</div>`;
        inp.value = "";
    }

    buildGrid();
</script>
</body>
</html>
       
     
