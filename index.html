<!DOCTYPE html>
<html lang="de">
<head>
    <script src='https://8x8.vc/vpaas-magic-cookie-39f826359e1345d38f8304910901e855/external_api.js'></script>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - Admin Modus</title>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <style>
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        
        /* TEXT-ANIMATION */
        #main-text { width: 85%; text-align: justify; color: #ccc; margin: 2vh auto; font-size: 1.3rem; line-height: 1.8; max-height: 50vh; overflow-y: auto; white-space: pre-wrap; }
        
        /* HEADER & DASHBOARD */
        .dashboard-header { width: 100%; position: absolute; top: 3%; display: flex; justify-content: flex-start; padding: 0 2%; box-sizing: border-box; z-index: 20; }
        .logo-ring { width: 110px; height: 110px; border: 3px solid #fff; background-color: #003d8f; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .logo-mm { font-size: 2rem; font-weight: 900; line-height: 0.8; }
        .logo-community { font-size: 0.6rem; letter-spacing: 1.5px; text-transform: uppercase; font-weight: bold; }
        .info-section { width: 80%; height: 26vh; border: 2px solid #003d8f; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #000; position: relative; overflow: hidden; margin-top: 2vh; }
        
        /* GRID */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); grid-auto-flow: column; gap: 10px; width: 95%; max-width: 1450px; margin-top: 30px; border: 3px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box, .fundament-box { display: flex; border: 2px solid #003d8f; background-color: #000; min-height: 58px; position: relative; overflow: hidden; }
        .num { width: 38px; display: flex; align-items: center; justify-content: center; background-color: #003d8f; font-weight: bold; flex-shrink: 0; font-size: 0.85rem; }
        .num-fertig { background-color: #00ff00 !important; color: #000 !important; }
        .text { padding: 4px 8px; text-transform: uppercase; font-size: 0.6rem; display: flex; align-items: center; cursor: pointer; flex-grow: 1; font-weight: 600; }

        /* EBENEN-STRUKTUR */
        .tafel-layout { display: flex; align-items: center; justify-content: center; width: 100%; position: relative; margin-top: 1vh; height: 26vh; min-height: 26vh; }
        .info-section-ebene { width: 90% !important; height: 100%; border: 2px solid #003d8f; background-color: #000; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }
        .buttons-links, .buttons-rechts { position: absolute; display: flex; flex-direction: column; gap: 15px; z-index: 20; }
        .buttons-links { left: 1.5%; } .buttons-rechts { right: 1.5%; }
        .oval-side { width: 45px; height: 22px; border-radius: 12px; border: 1px solid #fff; opacity: 0.8; transition: all 0.3s; cursor: pointer; }
        .ov-schwarz { background: #000; border: 1.5px solid #003d8f; } .ov-grun { background: #00ff00; } .ov-blau { background: #0000ff; } .ov-rot { background: #ff0000; } .ov-pink { background: #ff00ff; } .ov-gelb { background: #ffff00; }

        /* CHAT */
        #chat-area { width: 90%; height: 45vh; display: none; flex-direction: column; margin: 0 auto 70px auto; }
        .chat-msgs { flex: 1; padding: 10px 0; color: #fff; overflow-y: auto; }
        .chat-input-row { display: flex; border: 1px solid #003d8f; background: rgba(0,0,0,0.9); padding: 5px; }

        /* EBENE 4 & SCHUBLADEN */
        #drawer-ebene4 { display: none; width: 95%; flex-direction: column; height: 85vh; overflow-y: auto; }
        #jitsi-container { width: 100%; height: 500px; border: 2px solid #ff0000; margin-bottom: 20px; flex-shrink: 0; }
        .schublade { border: 1px solid #003d8f; margin-bottom: 5px; background: #050505; }
        .schublade-header { padding: 15px; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; background: #001a3d; }
        .schublade-content { padding: 0; max-height: 0; overflow: hidden; transition: max-height 0.4s ease; background: #000; }
        .schublade.open > .schublade-content { max-height: 1000px; padding: 15px; }
        .schublade-textarea { width: 100%; height: 200px; background: #111; border: 1px solid #333; color: #fff; padding: 10px; box-sizing: border-box; }
        .save-btn { background: #00ff00; color: #000; border: none; padding: 8px; margin-top: 5px; cursor: pointer; font-weight: bold; }

        /* NAV */
        .bottom-nav { display: flex; justify-content: space-between; width: 100%; padding: 10px 20px; position: fixed; bottom: 0; background: #000; border-top: 1px solid #333; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        .dot { width: 10px; height: 10px; background: #444; border-radius: 50%; }
        .dot.active { background: #ffd700; }

        .werbe-bild-bg { position: absolute; top:0; left:0; width:100%; height:100%; background-size:cover; opacity:0; z-index:1; }
        .bild-aktiv { animation: fadeEffect 10s infinite; opacity: 0.4; }
        @keyframes fadeEffect { 0% { opacity: 0; } 50% { opacity: 0.4; } 100% { opacity: 0; } }
    </style>
</head>
<body>

    <div id="dashboard" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <div class="dashboard-header">
            <div class="logo-ring" ondblclick="adminUnlock()"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div>
        </div>
        <div class="info-section">
            <h1 style="font-size: 2.5rem; margin: 0; font-weight: 900;">DAS WAS & WARUM</h1>
            <h2 style="color: #003d8f; font-size: 1.5rem;">DIE STILLE MILLION</h2>
            <p style="max-width: 80%; color: #ccc; text-align: center;">Wahl der Vorsitzenden erst nach Erreichen der stillen Million.</p>
        </div>
        <div class="grid" id="main-grid"></div>
        <div style="display: flex; width: 95%; gap: 10px; margin: 10px 0;">
            <div class="fundament-box" style="flex: 1;"><div class="num">21</div><div class="text">Kapital und Verwaltung</div></div>
            <div class="fundament-box" style="flex: 1;"><div class="num">22</div><div class="text">DAS KOLLEKTIV</div></div>
        </div>
        <div class="zugang-container" style="display: flex; width: 95%; gap: 10px; margin-bottom: 80px;">
            <div class="fundament-box" style="flex: 1; border-color: #555; cursor: pointer;" onclick="showZugangInfo('gast')"><div class="num" style="background:#333">G</div><div class="text">Gast</div></div>
            <div class="fundament-box" style="flex: 1; border-color: #8b00ff; cursor: pointer;" onclick="showZugangInfo('email')"><div class="num" style="background:#8b00ff">V</div><div class="text" style="color:#ffd700">Verifiziert</div></div>
        </div>
    </div>

    <div id="page-skelett" style="display: none; width: 100%; flex-direction: column; align-items: center;">
        <div class="top-container" style="width: 100%; text-align: center;">
            <h1 id="info-titel" class="page-title-white" style="text-transform: uppercase;"></h1>
            <div class="tafel-layout">
                <div class="buttons-links">
                    <div class="oval-side ov-schwarz" onclick="showDashboard()"></div>
                    <div class="oval-side ov-grun" onclick="setEbene(2)"></div>
                    <div class="oval-side ov-blau" onclick="setEbene(3)"></div>
                    <div class="oval-side ov-rot" onclick="portalZuEbene4()"></div>
                </div>
                <div class="info-section-ebene">
                    <div class="werbe-bild-bg" id="werbe-bg"></div>
                    <div style="z-index: 5; color: rgba(255,255,255,0.3);">STILLE MILLION: <span class="counter-value">842.336</span></div>
                </div>
                <div class="buttons-rechts">
                    <div class="oval-side ov-grun"></div>
                    <div class="oval-side ov-blau"></div>
                    <div class="oval-side ov-pink"></div>
                    <div class="oval-side ov-gelb" onclick="setEbene(3)"></div>
                </div>
            </div>
        </div>
        
        <p id="main-text"></p>
        
        <div id="chat-area">
            <div class="chat-msgs" id="chat-box"></div>
            <div class="chat-input-row">
                <input type="text" id="chat-input" placeholder="Nachricht..." style="flex:1; background:transparent; border:none; color:#fff; padding:10px; outline:none;">
                <button onclick="registriereSenden()" style="background:#003d8f; color:#fff; border:none; padding:0 20px; cursor:pointer;">SENDEN</button>
            </div>
        </div>

        <div id="drawer-ebene4">
            <div id="jitsi-container"></div>
            <div id="sektoren-schubladen"></div>
        </div>
    </div>

    <div class="bottom-nav">
        <button class="nav-btn" onclick="showDashboard()">‚Üê Dashboard</button>
        <div style="display: flex; gap: 8px;" id="dot-holder"></div>
        <button class="nav-btn" onclick="nextPage()">Weiter ‚Üí</button>
    </div>

<script>
    let userBackstage = JSON.parse(localStorage.getItem('mm_user_data')) || { sektorNotizen: {}, besuchteSektoren: [], isVerifiziert: false };

    const themen = [
        "( von M&M Community )<br>Recht auf Gef√ºhlsvorderung oder KI", "Wie werde ich Mensch", "Glaube an Friede", "Programm f√ºr B√ºrgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber f√ºr Pensionisten", "Nachbarschaft und Gemeinschaft", "Sozialgefallen und Widerkehr", "Alleinerziehend & Kind", "Die Br√ºcke"
    ];

    const DASHBOARD_TRUTH = {
        1: { content: `Die digitale Welt hat eine Schicht aus Taubheit √ºber das menschliche Erleben gelegt... Sektor 1 ist das Fundament dieser Bewegung.` },
        2: { content: `Die Verbreitung der Menschlichkeit markiert den entscheidenden √úbergang... Der Schmerz ist der Kompass.` },
        3: { content: `Wahrer innerer Friede ist kein passiver Zustand, sondern die Heilung... Hass zerfrisst den K√∂rper.` },
        4: { content: `Die politische Befreiung des Individuums ist untrennbar mit Geist und Gesetz verbunden. Geheimhaltung herrscht.` },
        5: { content: `Wahre Verantwortung ist keine Last, sondern Ausdruck der Souver√§nit√§t. Keine Ausreden mehr.` },
        6: { content: `Die Wiederherstellung der Menschlichkeit ist der fundamentale Akt der Rebellion gegen Entfremdung.` },
        7: { content: `Wahrer Kinderschutz findet seine Wurzeln in der kompromisslosen Ehrlichkeit der Eltern.` },
        8: { content: `Wahre Kunst ist niemals nur gef√§llige Dekoration; sie ist der radikale Ausbruch der Ur-Kraft.` },
        9: { content: `Sexualit√§t ist ein privater, heiliger Energiefluss. Das Diplom Gottes verk√ºndet: Unantastbar.` },
        10: { content: `Trend und Tradition sind die unsichtbaren Waffen. Wir kehren zur√ºck zum echten Zusammenhalt.` },
        11: { content: `Religionsbekenntnis oder Selbstwahl. Der Spiegel der Biografie zeigt: Die Sehnsucht ist dieselbe.` },
        12: { content: `Gesundheitswesen und Verhalten. Wer sein Verhalten √§ndert, √§ndert seine Chemie.` },
        13: { content: `Arbeitswelt und Du. Wir sprengen das Modell der Lohnsklaverei. Arbeit folgt der Resonanz.` },
        14: { content: `Mobbing am Arbeitsplatz. Wer andere klein macht, hat den Vertrag mit der Menschlichkeit gek√ºndigt.` },
        15: { content: `Jugendsprecher. Keine Kinderecke, sondern das Megafon der Zukunft.` },
        16: { content: `Ratgeber f√ºr Pensionisten. Beendigung der Abstellgleis-Mentalit√§t. Die Ehre des Alters z√§hlt.` },
        17: { content: `Nachbarschaft und Gemeinschaft. R√ºckeroberung des Lebensraums gegen die Vereinsamung.` },
        18: { content: `Sozialgefallen und Widerkehr. Was du aussendest, kommt mit der Wucht deiner Aufrichtigkeit zur√ºck.` },
        19: { content: `Alleinerziehend & Kind. Anerkennung der Elite der menschlichen Belastbarkeit.` },
        20: { content: `Die Br√ºcke. Wo alle Str√∂me zusammenflie√üen. Das Versprechen der gelebten Realit√§t.` }
    };

    let ebene = 1, tId = 0, aktuellesThema = "", jitsiApi = null;
    const ably = new Ably.Realtime('IO8wIA.C7HVjQ:SdzgpyD0_ilg8UOO-mXm94ro0VtTUSao8HUMoW7538sA');
    const meinTabId = Math.random().toString(36).substring(7);

    function initApp() {
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        themen.forEach((t, i) => {
            const statusClass = userBackstage.besuchteSektoren.includes(i) ? 'num-fertig' : '';
            grid.innerHTML += `<div class="box"><div class="num ${statusClass}">${i+1}</div><div class="text" onclick="checkAccess(${i}, '${t}')">${t}</div></div>`;
        });
        
        const dots = document.getElementById('dot-holder');
        dots.innerHTML = "";
        for (let i = 1; i <= 4; i++) dots.innerHTML += `<div id="dot${i}" class="dot ${i === ebene ? 'active' : ''}"></div>`;

        // Schubladen-Zentrale bauen
        const drawerArea = document.getElementById('sektoren-schubladen');
        drawerArea.innerHTML = `
            <div class="schublade" id="master-drawer">
                <div class="schublade-header" onclick="toggleDrawer('master')" style="background:#ffd700; color:#000">
                    <span>üìÇ SEKTOREN-ZENTRALE (1-20)</span><span id="arr-master">‚ñº</span>
                </div>
                <div class="schublade-content" id="master-content"></div>
            </div>`;
        
        const inner = document.getElementById('master-content');
        themen.forEach((t, i) => {
            const note = userBackstage.sektorNotizen[i] || "";
            inner.innerHTML += `
                <div class="schublade" id="sub-${i}">
                    <div class="schublade-header" onclick="toggleDrawer(${i})" style="font-size:0.8rem">
                        <span>SEKTOR ${i+1}</span><span id="arr-${i}">‚ñº</span>
                    </div>
                    <div class="schublade-content">
                        <textarea id="note-${i}" class="schublade-textarea">${note}</textarea>
                        <button class="save-btn" onclick="saveNote(${i})">SPEICHERN</button>
                    </div>
                </div>`;
        });
    }

    function checkAccess(id, t) {
        tId = id; aktuellesThema = t;
        if (!userBackstage.besuchteSektoren.includes(id)) { userBackstage.besuchteSektoren.push(id); saveToStorage(); }
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('page-skelett').style.display = 'flex';
        document.getElementById('info-titel').innerHTML = t;
        document.getElementById('main-text').innerText = DASHBOARD_TRUTH[id+1].content;
        setEbene(2);
        startRotation();
    }

    function setEbene(n) {
        ebene = n;
        document.getElementById('main-text').style.display = (n === 2) ? 'block' : 'none';
        document.getElementById('chat-area').style.display = (n === 3) ? 'flex' : 'none';
        document.getElementById('drawer-ebene4').style.display = (n === 4) ? 'flex' : 'none';
        for (let i = 1; i <= 4; i++) document.getElementById('dot'+i).classList.toggle('active', i === n);
    }

    function toggleDrawer(id) {
        const target = (id === 'master') ? document.getElementById('master-drawer') : document.getElementById('sub-'+id);
        target.classList.toggle('open');
    }

    function saveNote(id) {
        userBackstage.sektorNotizen[id] = document.getElementById('note-'+id).value;
        saveToStorage();
        alert("Im Buckel gesichert, Schwein!");
    }

    function portalZuEbene4() {
        if (!userBackstage.isVerifiziert) { alert("Nur f√ºr verifizierte Seelen!"); return; }
        setEbene(4);
        if (jitsiApi) jitsiApi.dispose();
        jitsiApi = new JitsiMeetExternalAPI("8x8.vc", {
            roomName: "MM-Sektor-" + tId, width: "100%", height: "100%",
            parentNode: document.querySelector('#jitsi-container'),
            userInfo: { displayName: 'Ober-Schwein' }
        });
    }

    function showDashboard() { location.reload(); }
    function nextPage() { if (ebene < 4) setEbene(ebene + 1); }
    function saveToStorage() { localStorage.setItem('mm_user_data', JSON.stringify(userBackstage)); }
    function adminUnlock() { if (prompt("Code?") === "frosch2026") { userBackstage.isVerifiziert = true; saveToStorage(); location.reload(); } }
    function startRotation() { document.getElementById('werbe-bg').style.backgroundImage = `url('https://picsum.photos/seed/${tId}/1200/600')`; document.getElementById('werbe-bg').classList.add('bild-aktiv'); }

    window.onload = initApp;
</script>
</body>
</html>
