<!DOCTYPE html>
<html lang="de">
<head>
    <script src='https://8x8.vc/vpaas-magic-cookie-39f826359e1345d38f8304910901e855/external_api.js'></script>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - Admin Modus</title>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <style>
        /* BASIS-LAYOUT */
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }

        /* ANIMATIONEN */
        @keyframes textErscheinung {
            0% { opacity: 0; filter: blur(10px); transform: translateY(20px); }
            100% { opacity: 1; filter: blur(0); transform: translateY(0); }
        }
        #main-text {
            width: 85%;
            text-align: justify;
            color: #ccc;
            margin: 2vh auto;
            font-size: 1.3rem;
            line-height: 1.8;
            max-height: 50vh;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .wahrheits-text {
            animation: textErscheinung 2.5s ease-out forwards;
            color: #fff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            font-style: italic;
        }
        @keyframes kenburns { 0% { transform: scale(1) translate(0, 0); } 50% { transform: scale(1.15) translate(-1%, -1%); } 100% { transform: scale(1) translate(0, 0); } }
        @keyframes fadeEffect { 0% { opacity: 0; } 15% { opacity: 0.4; } 85% { opacity: 0.4; } 100% { opacity: 0; } }
        @keyframes signalBlink { 0% { box-shadow: 0 0 5px #fff; opacity: 0.8; } 50% { box-shadow: 0 0 25px #fff, 0 0 35px #003d8f; opacity: 1; transform: scale(1.05); } 100% { box-shadow: 0 0 5px #fff; opacity: 0.8; } }
        
        .elite-aktiv { background-color: #ffd700 !important; box-shadow: 0 0 10px #ffd700; border: 2px solid #fff !important; cursor: pointer; }
        .signal-aktiv { animation: signalBlink 1.0s infinite ease-in-out !important; border: 2px solid #fff !important; cursor: pointer; }

        /* HEADER & TAFEL */
        .dashboard-header { width: 100%; position: absolute; top: 3%; display: flex; justify-content: flex-start; padding: 0 2%; box-sizing: border-box; z-index: 20; }
        .logo-ring { width: 110px; height: 110px; border: 3px solid #fff; background-color: #003d8f; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .logo-mm { font-size: 2rem; font-weight: 900; line-height: 0.8; }
        .logo-community { font-size: 0.6rem; letter-spacing: 1.5px; text-transform: uppercase; font-weight: bold; }
        
        .tafel-layout { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            width: 100%; 
            position: relative; 
            margin-top: 1vh; 
            height: 26vh; 
            min-height: 26vh; 
            flex-shrink: 0; 
        }
        .info-section-ebene { width: 90% !important; height: 100%; border: 2px solid #003d8f; background-color: #000; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }

        /* DASHBOARD GRID */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 95%; max-width: 1450px; margin-top: 30px; border: 3px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box { display: flex; border: 2px solid #003d8f; background-color: #000; min-height: 58px; position: relative; }
        .num { width: 38px; display: flex; align-items: center; justify-content: center; background-color: #003d8f; font-weight: bold; font-size: 0.85rem; }
        .text { padding: 4px 8px; text-transform: uppercase; font-size: 0.6rem; display: flex; align-items: center; cursor: pointer; flex-grow: 1; font-weight: 600; }
        .num-fertig { background-color: #00ff00 !important; color: #000 !important; }

        /* EBENE 4: DIE ARCHIV-ZENTRALE */
        #drawer-ebene4 { 
            display: none; 
            width: 90%; 
            height: 75vh; 
            flex-direction: column; 
            overflow-y: auto; 
            padding-bottom: 120px; 
            margin-top: 10px;
        }

        #sektoren-schubladen { width: 100%; }
        .schublade { border: 1px solid #003d8f; margin-bottom: 10px; background: #050505; }
        
        .schublade-header { 
            padding: 15px; 
            font-size: 1rem; 
            font-weight: bold; 
            cursor: pointer; 
            display: flex; 
            justify-content: space-between; 
            background: #001a3d; 
            border-bottom: 1px solid #003d8f; 
        }

        .schublade-content { 
            display: none; 
            padding: 20px; 
            background: #000; 
            color: #ccc; 
            font-size: 0.95rem; 
            border-top: 1px solid #003d8f;
        }

        /* DIE MAGISCHE √ñFFNUNG */
        .schublade.open > .schublade-content { 
            display: block !important; 
        }

        /* NAVIGATION */
        .bottom-nav { display: flex; justify-content: space-between; width: 100%; padding: 10px 20px; position: fixed; bottom: 0; left: 0; box-sizing: border-box; background: #000; z-index: 100; border-top: 1px solid #333; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; border-radius: 5px; }
        .dot { width: 10px; height: 10px; background: #444; border-radius: 50%; }
        .dot.active { background: #ffd700; box-shadow: 0 0 10px #ffd700; }

        .werbe-bild-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0; z-index: 1; }
        .bild-aktiv { animation: kenburns 20s infinite ease-in-out, fadeEffect 10s infinite; }
    </style>
</head>
<body>
    <div id="dashboard" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <div class="dashboard-header">
            <div class="logo-ring" ondblclick="adminUnlock()"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div>
        </div>
        <div class="info-section" style="text-align:center; margin-top:120px;">
            <h1 style="font-size: 2.8rem; margin: 0; font-weight: 900;">DAS WAS & WARUM</h1>
            <h2 style="color: #003d8f; font-size: 1.8rem; margin: 5px 0;">DIE STILLE MILLION</h2>
            <p style="max-width: 85%; color: #ccc; font-size: 1.1rem; margin: 10px 0 0 0;">
                Die M&M-Community ist das Fundament f√ºr alle. <strong>Die Wahl der Vorsitzenden erfolgt erst nach Erreichen der stillen Million.</strong>
            </p>
        </div>
        <div class="grid" id="main-grid"></div>
        <div class="fundament-container" style="display: flex; width: 95%; max-width: 1450px; gap: 10px; margin-top: 10px; margin-bottom: 10px;">
            <div class="box" style="flex: 1;"><div class="num">21</div><div class="text">Kapital und Verwaltung</div></div>
            <div class="box" style="flex: 1;"><div class="num">22</div><div class="text">DAS KOLLEKTIV</div></div>
        </div>

        <div class="zugang-container" style="display: flex; width: 95%; max-width: 1450px; gap: 10px; margin-bottom: 80px;">
            <div class="box" style="flex: 1; border-color: #555; cursor: pointer;" onclick="showZugangInfo('gast')">
                <div class="num" style="background-color: #333;">G</div>
                <div class="text">Gast-Zugang (Eingeschr√§nkt)</div>
            </div>
            <div class="box" style="flex: 1; border-color: #8b00ff; cursor: pointer;" onclick="showZugangInfo('email')">
                <div class="num" style="background-color: #8b00ff;">V</div>
                <div class="text" style="color: #ffd700;">Verifizierter Status (Voller Zugriff 1-4)</div>
            </div>
        </div>
    </div>

    <div id="zugang-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:10000; justify-content:center; align-items:center;">
        <div style="background:#000; border:2px solid #003d8f; padding:30px; width:400px; text-align:center; border-radius:10px;">
            <h3 id="modal-titel" style="color:#fff; margin-top:0;"></h3>
            <p id="modal-text" style="color:#ccc; font-size:0.9rem; line-height:1.5; margin:20px 0;"></p>
            <div id="email-input-field" style="display:none; margin-bottom:20px;">
                <input type="email" id="user-email-input" placeholder="Deine E-Mail Adresse" style="width:90%; padding:10px; background:#111; border:1px solid #8b00ff; color:#fff;">
            </div>
            <button id="modal-confirm-btn" style="background:#ffd700; color:#000; border:none; padding:10px 20px; font-weight:bold; cursor:pointer; margin-right:10px;">AKZEPTIEREN</button>
            <button onclick="document.getElementById('zugang-modal').style.display='none'" style="background:#333; color:#fff; border:none; padding:10px 20px; cursor:pointer;">ABBRECHEN</button>
        </div>
    </div>

    <div id="page-skelett" style="display: none; width: 100%; flex-direction: column; align-items: center; height: 100vh;">
        <div class="top-container" style="width:100%;">
            <h1 id="info-titel" style="text-align:center;"></h1>
            <div id="ebene4-title-red" style="text-align:center; color:red; font-weight:bold; display:none;"></div>
            <div class="tafel-layout">
                <div class="info-section-ebene">
                    <div class="werbe-bild-bg" id="werbe-bg"></div>
                    <div id="counter-box" style="z-index:10; text-align:center;"><span style="font-size:0.4rem; color:#fff; display:block;">STILLE MILLION</span><span class="counter-value">842.336</span></div>
                </div>
            </div>
        </div>

        <p id="main-text"></p>

        <div id="chat-area" style="display:none; width:90%; flex-direction:column;">
            <div class="chat-msgs" id="chat-box" style="height:200px; overflow-y:auto; border:1px solid #333; padding:10px;"></div>
            <div class="chat-input-row" style="display:flex;">
                <input type="text" id="chat-input" placeholder="Nachricht schreiben..." style="flex:1; background:#111; border:1px solid #333; color:#fff; padding:10px;">
                <button onclick="registriereSenden()" style="background:#003d8f; color:#fff; border:none; padding:0 20px;">SENDEN</button>
            </div>
        </div> 

        <div id="drawer-ebene4">
            <div id="jitsi-container" style="width:100%; height:300px; background:#111; border:1px solid #ff0000; margin-bottom:20px;"></div>
            <div id="sektoren-schubladen"></div>
        </div> 
    </div>

    <div class="bottom-nav">
        <button id="btn-back" class="nav-btn" onclick="showDashboard()">‚Üê Dashboard</button>
        <div style="display: flex; gap: 8px; align-items: center;" id="dot-holder"></div>
        <button id="btn-next" class="nav-btn" onclick="nextPage()">Weiter ‚Üí</button>
    </div>
<script>
    let userBackstage = JSON.parse(localStorage.getItem('mm_user_data')) || { 
        sektorNotizen: {}, 
        besuchteSektoren: [],
        isVerifiziert: false 
    };

    const themen = [
        "( von M&M Community )<br>Recht auf Gef√ºhlsvorderung oder KI", "Wie werde ich Mensch", "Glaube an Friede", 
        "Programm f√ºr B√ºrgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", 
        "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", 
        "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", 
        "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber f√ºr Pensionisten", "Nachbarschaft und Gemeinschaft", 
        "Sozialgefallen und Widerkehr", "Alleinerziehend & Kind", "Die Br√ºcke"
    ];

    const DASHBOARD_TRUTH = {
        1: { title: "Recht auf Gef√ºhlsvorderung oder KI", content: `Die digitale Welt hat eine Schicht aus Taubheit √ºber das menschliche Erleben gelegt...` },
        2: { title: "Wie werde ich Mensch", content: `Die Verbreitung der Menschlichkeit markiert den entscheidenden √úbergang...` },
        3: { title: "Glaube an Friede", content: `Wahrer innerer Friede ist kein passiver Zustand...` },
        4: { title: "Programm f√ºr B√ºrgerliche Rechte", content: `Die politische Befreiung des Individuums ist untrennbar...` },
        5: { title: "Moralische Pflicht und Verantwortung", content: `Wahre Verantwortung ist keine Last...` },
        6: { title: "Menschlichkeit Wiederherstellung", content: `Die Wiederherstellung der Menschlichkeit ist der fundamentale Akt...` },
        7: { title: "Kinderschutz-Pflicht-Elternrechte", content: `Wahrer Kinderschutz findet seine Wurzeln...` },
        8: { title: "Wahre Richtung und Kunst", content: `Wahre Kunst ist niemals nur gef√§llige Dekoration...` },
        9: { title: "LGBTQ und Kirche", content: `In diesem Sektor vollziehen wir die notwendige Heilung...` },
        10: { title: "Trend and Tradition", content: `Trend und Tradition sind die unsichtbaren Waffen...` },
        11: { title: "Religionsbekenntnis oder Selbstwahl", content: `In diesem Sektor laden wir die Seele ein...` },
        12: { title: "Gesundheitswesen und Verhalten", content: `In diesem Sektor vollziehen wir den radikalen Bruch...` },
        13: { title: "Arbeitswelt und Du", content: `In diesem Sektor sprengen wir das Modell der modernen Lohnsklaverei...` },
        14: { title: "Mobbing am Arbeitsplatz", content: `Mobbing ist kein privater Konflikt...` },
        15: { title: "Jugendsprecher", content: `In diesem Sektor geben wir der Zukunft ein Megafon...` },
        16: { title: "Ratgeber f√ºr Pensionisten", content: `In diesem Sektor beenden wir die Schande...` },
        17: { title: "Nachbarschaft und Gemeinschaft", content: `In diesem Sektor zertr√ºmmern wir die Anonymit√§t...` },
        18: { title: "Sozialgefallen und Widerkehr", content: `In diesem Sektor entschl√ºsseln wir das Gesetz der energetischen Ernte...` },
        19: { title: "Alleinerziehend & Kind", content: `In diesem Sektor korrigieren wir eine der gr√∂√üten Ungerechtigkeiten...` },
        20: { title: "Die Br√ºcke", content: `In diesem Sektor flie√üen alle Str√∂me zusammen...` }
    };

    let ebene = 1, tId = 0, aktuellesThema = "";
    let jitsiApi = null;
    const ably = new Ably.Realtime('IO8wIA.C7HVjQ:SdzgpyD0_ilg8UOO-mXm94ro0VtTUSao8HUMoW7538sA'); 
    const meinTabId = Math.random().toString(36).substring(7);
    let aktuellerChannel = null;

    function updateCounter() {
        let currentCount = parseInt(localStorage.getItem('stille_million')) || 842336;
        currentCount += Math.floor(Math.random() * 5) + 1; 
        localStorage.setItem('stille_million', currentCount);
        const counterDisplay = document.querySelector('.counter-value');
        if(counterDisplay) counterDisplay.innerText = currentCount.toLocaleString('de-DE');
    }
    setInterval(updateCounter, 10000);

    function initApp() {
        const grid = document.getElementById('main-grid');
        if (grid) {
            grid.innerHTML = "";
            themen.forEach((thema, index) => {
                const box = document.createElement('div');
                box.className = 'box';
                const istBesucht = userBackstage.besuchteSektoren.includes(index);
                const numClass = istBesucht ? "num-fertig" : "num-neutral";
                box.innerHTML = `<div class="num ${numClass}">${index + 1}</div><div class="text" onclick="checkAccess(${index}, '${thema}')">${thema}</div>`;
                grid.appendChild(box);
            });
        }

        const drawerArea = document.getElementById('sektoren-schubladen');
        if (drawerArea) {
            drawerArea.innerHTML = ""; 
            const masterSchublade = document.createElement('div');
            masterSchublade.className = 'schublade';
            masterSchublade.id = 'master-archiv-container';
            masterSchublade.innerHTML = `
                <div class="schublade-header" onclick="toggleDrawer('master')" style="background: #ffd700; color: #000; cursor: pointer;">
                    <span>üìÇ SEKTOREN-ZENTRALE (1-20)</span><span id="arrow-master">‚ñº</span>
                </div>
                <div id="inneres-archiv" class="schublade-content" style="background: #000; padding: 10px; display: none;"></div>
            `;
            drawerArea.appendChild(masterSchublade);

            const archiv = document.getElementById('inneres-archiv');
            for (let i = 1; i <= 20; i++) {
                const daten = DASHBOARD_TRUTH[i];
                const gespeicherterText = userBackstage.sektorNotizen[i] || "";
                const sektorDiv = document.createElement('div');
                sektorDiv.className = 'schublade';
                sektorDiv.id = `drawer-${i}`;
                sektorDiv.innerHTML = `
                    <div class="schublade-header" onclick="toggleDrawer(${i})" style="font-size: 0.8rem; background: #111; color: #ffd700;">
                        <span>SEKTOR ${i}: ${daten ? daten.title : "..."}</span><span id="arrow-${i}">‚ñº</span>
                    </div>
                    <div class="schublade-content" style="display: none; background: #050505;">
                        <div style="color: #fff; padding: 10px;">${daten ? daten.content : "..."}</div>
                        <textarea id="note-${i}" style="width: 100%; height: 60px; background: #111; color: #fff; border: 1px solid #ffd700;">${gespeicherterText}</textarea>
                        <button onclick="saveNote(${i})" style="background: #ffd700; color: #000; margin-top: 5px;">SICHERN</button>
                    </div>`;
                archiv.appendChild(sektorDiv);
            }
        }
        const dots = document.getElementById('dot-holder');
        if (dots) {
            dots.innerHTML = "";
            for (let i = 1; i <= 4; i++) dots.innerHTML += `<div id="dot${i}" class="dot ${i === 1 ? 'active' : ''}"></div>`;
        }
    }

   function checkAccess(id, t) {
        tId = id; aktuellesThema = t;
        if (!userBackstage.besuchteSektoren.includes(id)) { userBackstage.besuchteSektoren.push(id); saveToStorage(); }
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('page-skelett').style.display = 'flex';
        const wahreDaten = DASHBOARD_TRUTH[id + 1];
        document.getElementById('main-text').innerText = wahreDaten ? wahreDaten.content : "Forschung l√§uft...";
        document.getElementById('info-titel').innerHTML = t;
        setEbene(2); startRotation(); verbindeMitSektorChat(id);
    }

    function setEbene(n) {
        ebene = n;
        updateUI();
    }

    function updateUI() {
        document.getElementById('chat-area').style.display = (ebene === 3) ? 'flex' : 'none';
        document.getElementById('drawer-ebene4').style.display = (ebene === 4) ? 'flex' : 'none';
        document.getElementById('main-text').style.display = (ebene === 2) ? 'block' : 'none';
        const ebene4Titel = document.getElementById('ebene4-title-red');
        if (ebene === 4) { ebene4Titel.style.display = 'block'; ebene4Titel.innerText = "SEKTOR KONFERENZ: " + aktuellesThema; }
        else { ebene4Titel.style.display = 'none'; }
        for (let i = 1; i <= 4; i++) { const dot = document.getElementById('dot' + i); if (dot) dot.classList.toggle('active', i === ebene); }
    }

    function saveToStorage() { localStorage.setItem('mm_user_data', JSON.stringify(userBackstage)); }
    function saveNote(id) { userBackstage.sektorNotizen[id] = document.getElementById(`note-${id}`).value; saveToStorage(); alert("Im Buckel gesichert!"); }
    function showDashboard() { if (jitsiApi) jitsiApi.dispose(); ebene = 1; document.getElementById('page-skelett').style.display = 'none'; document.getElementById('dashboard').style.display = 'flex'; initApp(); }
    function nextPage() { if (ebene < 4) setEbene(ebene + 1); }

    function toggleDrawer(id) {
        let target = (id === 'master') ? document.getElementById('master-archiv-container') : document.getElementById('drawer-' + id);
        let arrow = (id === 'master') ? document.getElementById('arrow-master') : document.getElementById('arrow-' + id);
        if (target) {
            target.classList.toggle('open');
            if (arrow) arrow.innerText = target.classList.contains('open') ? "‚ñ≤" : "‚ñº";
        }
    }

    function startRotation() {
        const bg = document.getElementById('werbe-bg');
        if (bg) { bg.style.backgroundImage = `url('https://picsum.photos/seed/${tId + 99}/1200/600')`; bg.classList.add('bild-aktiv'); bg.style.opacity = "0.4"; }
    }

    function verbindeMitSektorChat(sektorId) {
        if (aktuellerChannel) { aktuellerChannel.unsubscribe(); }
        aktuellerChannel = ably.channels.get('mm-sektor-' + sektorId);
        aktuellerChannel.subscribe('message', (msg) => {
            if (msg.data.senderId !== meinTabId) {
                const cb = document.getElementById('chat-box');
                if (cb) cb.innerHTML += `<div style="color: #ffd700;"><strong>Partner:</strong> ${msg.data.text}</div>`;
            }
        });
    }

    function registriereSenden() {
        const input = document.getElementById('chat-input'), text = input.value.trim();
        if (text === "" || !aktuellerChannel) return;
        aktuellerChannel.publish('message', { text: text, senderId: meinTabId });
        document.getElementById('chat-box').innerHTML += `<div><strong>Du:</strong> ${text}</div>`;
        input.value = "";
    }

    function portalZuEbene4() {
        if (!userBackstage.isVerifiziert) { alert("Nur f√ºr verifizierte Seelen!"); return; }
        setEbene(4);
        if (jitsiApi) jitsiApi.dispose();
        const domain = "8x8.vc";
        const options = {
            roomName: "MM-Sektor-" + tId, width: "100%", height: "100%",
            parentNode: document.querySelector('#jitsi-container'),
            userInfo: { displayName: 'Ober-Schwein' }
        };
        jitsiApi = new JitsiMeetExternalAPI(domain, options);
    }

    window.onload = initApp;

    function adminUnlock() {
        if (prompt("Code?") === "frosch2026") {
            userBackstage.isVerifiziert = true;
            saveToStorage();
            location.reload();
        }
    }

    function showZugangInfo(typ) {
        const modal = document.getElementById('zugang-modal');
        modal.style.display = 'flex';
        document.getElementById('modal-titel').innerText = typ === 'gast' ? "GAST-ZUGANG" : "VERIFIZIERUNG";
        document.getElementById('modal-text').innerText = typ === 'gast' ? "Nur Lesezugriff." : "Werde Teil des Kollektivs.";
        document.getElementById('email-input-field').style.display = typ === 'email' ? 'block' : 'none';
        document.getElementById('modal-confirm-btn').onclick = () => { if(typ==='email') alert("Link gesendet!"); modal.style.display = 'none'; };
    }
</script>
</body>
</html>
