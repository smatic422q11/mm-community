<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - Stabile Basis</title>
    <style>
        /* Hier bleibt dein komplettes CSS exakt so wie in deinem Post */
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        @keyframes kenburns { 0% { transform: scale(1) translate(0, 0); } 50% { transform: scale(1.15) translate(-1%, -1%); } 100% { transform: scale(1) translate(0, 0); } }
        @keyframes fadeEffect { 0% { opacity: 0; } 15% { opacity: 0.4; } 85% { opacity: 0.4; } 100% { opacity: 0; } }
        @keyframes signalBlink { 0% { box-shadow: 0 0 5px #fff; opacity: 0.8; } 50% { box-shadow: 0 0 25px #fff, 0 0 35px #003d8f; opacity: 1; transform: scale(1.05); } 100% { box-shadow: 0 0 5px #fff; opacity: 0.8; } }
        .elite-aktiv { background-color: #ffd700 !important; box-shadow: 0 0 10px #ffd700; border: 2px solid #fff !important; cursor: pointer; }
        .signal-aktiv { animation: signalBlink 1.0s infinite ease-in-out !important; border: 2px solid #fff !important; cursor: pointer; }
        .dashboard-header { width: 100%; position: absolute; top: 3%; display: flex; justify-content: flex-start; padding: 0 2%; box-sizing: border-box; z-index: 20; }
        .logo-ring { width: 110px; height: 110px; border: 3px solid #fff; background-color: #003d8f; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .logo-mm { font-size: 2rem; font-weight: 900; line-height: 0.8; }
        .logo-community { font-size: 0.6rem; letter-spacing: 1.5px; text-transform: uppercase; font-weight: bold; }
        .info-section { width: 80%; height: 26vh; border: 2px solid #003d8f; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #000; position: relative; overflow: hidden; margin-top: 2vh; }
        .tafel-layout { display: flex; align-items: center; justify-content: center; width: 100%; position: relative; margin-top: 1vh; height: 26vh; min-height: 26vh; flex-shrink: 0; }
        .info-section-ebene { width: 90% !important; height: 100%; border: 2px solid #003d8f; background-color: #000; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }
        .buttons-links, .buttons-rechts { position: absolute; display: flex; flex-direction: column; gap: 15px; z-index: 20; }
        .buttons-links { left: 1.5%; } .buttons-rechts { right: 1.5%; }
        .oval-side { width: 45px; height: 22px; border-radius: 12px; border: 1px solid #fff; opacity: 0.8; transition: all 0.3s; }
        .ov-schwarz { background: #000; border: 1.5px solid #003d8f; } .ov-rot { background: #ff0000; } .ov-gelb { background: #ffff00; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); grid-auto-flow: column; gap: 10px; width: 95%; max-width: 1450px; margin-top: 30px; border: 3px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box, .fundament-box { display: flex; border: 2px solid #003d8f; background-color: #000; min-height: 58px; position: relative; overflow: hidden; }
        .num { width: 38px; display: flex; align-items: center; justify-content: center; background-color: #003d8f; font-weight: bold; flex-shrink: 0; font-size: 0.85rem; }
        .text { padding: 4px 8px; text-transform: uppercase; font-size: 0.6rem; display: flex; align-items: center; cursor: pointer; flex-grow: 1; font-weight: 600; }
        #chat-area { width: 90%; height: 45vh; display: none; flex-direction: column; margin: 0 auto 70px auto; overflow: hidden; }
        .chat-msgs { flex: 1; display: flex; flex-direction: column; justify-content: flex-end; padding: 10px 0; color: #fff; overflow-y: auto; scrollbar-width: none; }
        .chat-input-row { display: flex; border: 1px solid #003d8f; background: rgba(0, 0, 0, 0.9); padding: 5px; margin-top: 5px; }
        #drawer-ebene4 { width: 90%; display: none; flex-direction: column; height: 60vh; overflow-y: auto; }
        .video-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .video-slot { aspect-ratio: 16/9; background: #111; border: 1px solid #003d8f; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #666; }
        .schublade { border: 1px solid #003d8f; margin-bottom: 10px; background: #050505; }
        .schublade-header { padding: 15px; cursor: pointer; display: flex; justify-content: space-between; background: #001a3d; }
        .schublade-content { padding: 0 15px; max-height: 0; overflow: hidden; transition: max-height 0.5s; }
        .schublade.open .schublade-content { max-height: 1200px; padding: 20px; }
        .schublade-textarea { width: 100%; height: 300px; background: #111; color: #fff; border: 1px solid #003d8f; padding: 10px; }
        .bottom-nav { display: flex; justify-content: space-between; width: 100%; padding: 10px 20px; position: fixed; bottom: 0; background: #000; border-top: 1px solid #333; z-index: 100; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        .dot { width: 10px; height: 10px; background: #444; border-radius: 50%; } .dot.active { background: #ffd700; }
        .num-neutral { background-color: #003d8f !important; } .num-gelesen { background-color: #ffd700 !important; color: #000 !important; }
        .num-offen { background-color: #ff4d4d !important; } .num-fertig { background-color: #00ff00 !important; color: #000 !important; }
        .werbe-bild-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; opacity: 0; transition: opacity 1s; }
        .bild-aktiv { animation: kenburns 20s infinite ease-in-out, fadeEffect 10s infinite; opacity: 0.4 !important; }
    </style>
</head>
<body>
    <div id="dashboard" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <div class="dashboard-header"><div class="logo-ring" ondblclick="adminUnlock()"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div></div>
        <div class="info-section">
            <h1 style="font-size: 2.8rem; margin: 0; font-weight: 900;">DAS WAS & WARUM</h1>
            <h2 style="color: #003d8f; font-size: 1.8rem; margin: 5px 0;">DIE STILLE MILLION</h2>
            <p style="max-width: 85%; color: #ccc; text-align: center;">Die M&M-Community ist das Fundament für alle.</p>
        </div>
        <div class="grid" id="main-grid"></div>
        </div>

    <div id="page-skelett" style="display: none; width: 100%; flex-direction: column; align-items: center;">
        <div class="top-container">
            <h1 id="info-titel" class="page-title-white"></h1>
            <div class="tafel-layout">
                <div class="buttons-links">
                    <div class="oval-side ov-schwarz" id="sig-l1"></div>
                    <div class="oval-side ov-rot" id="sig-l4" onclick="portalZuEbene4()"></div>
                </div>
                <div class="info-section-ebene"><div class="werbe-bild-bg" id="werbe-bg"></div></div>
                <div class="buttons-rechts"><div class="oval-side ov-gelb" id="sig-r4" onclick="portalZuEbene3()"></div></div>
            </div>
        </div>
        <p id="main-text" style="width: 85%; margin-top: 2vh; font-size: 1.2rem; line-height: 1.6;"></p>
        <div id="chat-area">
            <div class="chat-msgs" id="chat-box"></div>
            <div class="chat-input-row"><input type="text" id="chat-input" style="flex:1; background:transparent; color:#fff; padding:10px; border:none;" onkeypress="if(event.key==='Enter') registriereSenden()"><button onclick="registriereSenden()">SENDEN</button></div>
        </div>
        <div id="drawer-ebene4"><div id="sektoren-schubladen"></div></div>
    </div>

    <div class="bottom-nav"><button class="nav-btn" onclick="showDashboard()">← Dashboard</button><div style="display: flex; gap: 8px;" id="dot-holder"></div><button id="btn-next" class="nav-btn" onclick="nextPage()">Weiter →</button></div>

<script>
    // --- DIE STABILE LOGIK ---
    const themen = ["Recht auf Gefühls Forderung", "Wie werde ich Mensch", "Glaube an Friede", "Programm für Bürgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber für Pensionisten", "Sozialgefallen und Widerkehr", "Nachbarschaft und Gemeinschaft", "Mensch und Technik", "Die Brücke"];
    
    // Daten laden oder neu erstellen
    let db = JSON.parse(localStorage.getItem('mm_db')) || {
        user: { isVerifiziert: false, isQualifiziert: false },
        geleseneThemen: [],
        interaktionen: Array(20).fill(0),
        notizen: Array(20).fill("")
    };

    let ebene = 1, tId = 0;

    function save() { localStorage.setItem('mm_db', JSON.stringify(db)); }

    // Dashboard bauen
    const grid = document.getElementById('main-grid');
    themen.forEach((t, i) => {
        grid.innerHTML += `<div class="box" id="box-${i}"><div class="num" id="num-${i}">${i+1}</div><div class="text" onclick="checkAccess(${i})">${t}</div></div>`;
    });

    // Schubladen bauen
    const drawerArea = document.getElementById('sektoren-schubladen');
    themen.forEach((t, i) => {
        drawerArea.innerHTML += `
            <div class="schublade" id="drawer-${i}">
                <div class="schublade-header" onclick="toggleDrawer(${i})"><span>${t}</span><span>▼</span></div>
                <div class="schublade-content">
                    <textarea id="note-${i}" class="schublade-textarea" oninput="saveNote(${i}, this.value)">${db.notizen[i]}</textarea>
                </div>
            </div>`;
    });

    function checkAccess(id) {
        if (id === 0 || db.geleseneThemen.includes(id - 1) || db.user.isVerifiziert) {
            tId = id;
            if(!db.geleseneThemen.includes(id)) db.geleseneThemen.push(id);
            ebene = 2;
            showPage();
            save();
        } else { alert("Bitte Sektoren der Reihe nach freischalten!"); }
    }

    function showPage() {
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('page-skelett').style.display = 'flex';
        document.getElementById('info-titel').innerText = themen[tId];
        document.getElementById('main-text').innerText = "Inhalt für " + themen[tId] + "...";
        updateUI();
    }

    function updateUI() {
        document.getElementById('chat-area').style.display = (ebene === 3) ? 'flex' : 'none';
        document.getElementById('drawer-ebene4').style.display = (ebene === 4) ? 'flex' : 'none';
        document.getElementById('sig-r4').classList.toggle('signal-aktiv', ebene === 2 && db.geleseneThemen.length >= 20);
        document.getElementById('sig-l4').classList.toggle('signal-aktiv', ebene === 3 && db.interaktionen[tId] >= 20);
        
        // Dots
        document.getElementById('dot-holder').innerHTML = "";
        for(let i=1; i<=7; i++) {
            document.getElementById('dot-holder').innerHTML += `<div class="dot ${i===ebene?'active':''}"></div>`;
        }
        updateNumColors();
    }

    function saveNote(id, text) { db.notizen[id] = text; save(); }
    function toggleDrawer(i) { document.getElementById(`drawer-${i}`).classList.toggle('open'); }
    function showDashboard() { ebene = 1; document.getElementById('page-skelett').style.display = 'none'; document.getElementById('dashboard').style.display = 'flex'; updateNumColors(); }
    function portalZuEbene3() { if(db.geleseneThemen.length >= 20) { ebene = 3; updateUI(); } }
    function portalZuEbene4() { if(db.interaktionen[tId] >= 20) { ebene = 4; updateUI(); } }
    
    function registriereSenden() {
        db.interaktionen[tId]++;
        document.getElementById('chat-box').innerHTML += `<div>Nachricht ${db.interaktionen[tId]} gesendet...</div>`;
        document.getElementById('chat-input').value = "";
        updateUI();
        save();
    }

    function updateNumColors() {
        themen.forEach((_, i) => {
            const n = document.getElementById(`num-${i}`);
            if(!n) return;
            if (db.interaktionen[i] >= 20) n.className = "num num-fertig";
            else if (db.interaktionen[i] > 0) n.className = "num num-offen";
            else if (db.geleseneThemen.includes(i)) n.className = "num num-gelesen";
            else n.className = "num num-neutral";
        });
    }

    function adminUnlock() {
        db.user.isVerifiziert = true;
        db.geleseneThemen = Array.from({length: 20}, (_, i) => i);
        save();
        location.reload();
    }

    updateNumColors();
</script>
</body>
</html>
