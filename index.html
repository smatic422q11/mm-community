<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - Admin Modus</title>
    <style>
        /* BASIS-LAYOUT */
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }

        /* ANIMATIONEN */
        @keyframes kenburns { 0% { transform: scale(1) translate(0, 0); } 50% { transform: scale(1.15) translate(-1%, -1%); } 100% { transform: scale(1) translate(0, 0); } }
        @keyframes fadeEffect { 0% { opacity: 0; } 15% { opacity: 0.4; } 85% { opacity: 0.4; } 100% { opacity: 0; } }
        @keyframes signalBlink { 0% { box-shadow: 0 0 5px #fff; opacity: 0.8; } 50% { box-shadow: 0 0 25px #fff, 0 0 35px #003d8f; opacity: 1; transform: scale(1.05); } 100% { box-shadow: 0 0 5px #fff; opacity: 0.8; } }
        .signal-aktiv { animation: signalBlink 1.0s infinite ease-in-out !important; border: 2px solid #fff !important; cursor: pointer; }

        /* LILA BALKEN */
        .lila-registrierung-leiste { width: 100%; height: 80px; background: #8b00ff; border-top: 2px solid #fff; border-bottom: 2px solid #fff; display: flex; align-items: center; justify-content: center; margin-top: 20px; box-shadow: 0 0 20px #8b00ff; }
        .registrierung-text { color: #fff; font-size: 2.2rem; font-weight: 900; letter-spacing: 15px; text-transform: uppercase; }

        /* HEADER & TAFEL */
        .dashboard-header { width: 100%; position: absolute; top: 3%; display: flex; justify-content: flex-start; padding: 0 2%; box-sizing: border-box; z-index: 20; }
        .logo-ring { width: 110px; height: 110px; border: 3px solid #fff; background-color: #003d8f; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .logo-mm { font-size: 2rem; font-weight: 900; line-height: 0.8; }
        .logo-community { font-size: 0.6rem; letter-spacing: 1.5px; text-transform: uppercase; font-weight: bold; }
        
        .tafel-layout { display: flex; align-items: center; justify-content: center; width: 100%; position: relative; margin-top: 1vh; height: 26vh; min-height: 26vh; flex-shrink: 0; }
        .info-section-ebene { width: 90% !important; height: 100%; border: 2px solid #003d8f; background-color: #000; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }

        /* BUTTONS */
        .buttons-links { position: absolute; left: 1.5%; display: flex; flex-direction: column; gap: 15px; z-index: 20; }
        .buttons-rechts { position: absolute; right: 1.5%; display: flex; flex-direction: column; gap: 15px; z-index: 20; }
        .oval-side { width: 45px; height: 22px; border-radius: 12px; border: 1px solid #fff; opacity: 0.8; transition: all 0.3s; }
        .ov-schwarz { background: #000; border: 1.5px solid #003d8f; }
        .ov-grun { background: #00ff00; }
        .ov-blau { background: #0000ff; }
        .ov-rot { background: #ff0000; }
        .ov-pink { background: #ff00ff; }
        .ov-gelb { background: #ffff00; }

        /* DASHBOARD GRID */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); gap: 10px; width: 95%; max-width: 1450px; margin-top: 30px; border: 3px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box, .fundament-box { display: flex; border: 2px solid #003d8f; background-color: #000; min-height: 58px; position: relative; overflow: hidden; }
        .num { width: 38px; display: flex; align-items: center; justify-content: center; background-color: #003d8f; font-weight: bold; flex-shrink: 0; font-size: 0.85rem; }
        .text { padding: 4px 8px; text-transform: uppercase; font-size: 0.6rem; display: flex; align-items: center; cursor: pointer; flex-grow: 1; font-weight: 600; }

        /* EBENE 3: Chat-Bereich */
        #chat-area { width: 90% !important; height: 45vh; flex-grow: 1; display: none; flex-direction: column; margin: 0 auto 70px auto; position: relative; overflow: hidden; mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 100%); -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 100%); }
        .chat-msgs { flex: 1; display: flex; flex-direction: column; justify-content: flex-end; padding: 10px 0; color: #fff; font-size: 1.1rem; overflow-y: auto; scrollbar-width: none; }
        .chat-input-row { display: flex; border: 1px solid #003d8f; background: rgba(0, 0, 0, 0.9); padding: 5px; border-radius: 4px; flex-shrink: 0; margin-top: 5px; z-index: 10; }

        /* EBENE 4: SPEZIAL LOGIK */
        #drawer-ebene4 { width: 100%; display: none; flex-direction: column; align-items: center; overflow-y: auto; }
        .video-area-eb4 { width: 90%; display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-top: 10px; }
        .leiste-grun-freischalten { width: 90%; background: #00ff00; color: #000; padding: 12px; font-weight: 900; text-align: center; cursor: pointer; margin-top: 10px; border: none; text-transform: uppercase; }
        .sektor-leiste-aktiv { width: 90%; background: #001a3d; color: #fff; padding: 15px; border: 1px solid #003d8f; cursor: pointer; text-align: left; margin-top: 5px; font-weight: bold; }
        .schublade-inhalt-eb4 { width: 90%; display: none; background: #000; border: 1px solid #003d8f; border-top: none; }
        .schublade-textarea { width: 100%; min-height: 400px; background: #000; color: #fff; border: none; padding: 15px; font-size: 1.1rem; outline: none; resize: none; }

        /* --- LIVE KONFERENZ MODUS --- */
        .konferenz-live-aktiv #page-skelett { overflow: hidden; }
        .konferenz-live-aktiv .tafel-layout { height: auto; min-height: auto; }
        .konferenz-live-aktiv .info-section-ebene { display: grid !important; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(2, 1fr); height: 25vh; gap: 2px; background: #000; border: 2px solid #00ff00; }
        .konferenz-live-aktiv #schublade-container-eb4 { position: fixed; top: calc(25vh + 10px); bottom: 70px; width: 90%; left: 5%; overflow-y: auto; background: #000; z-index: 1000; display: block !important; }
        .konferenz-live-aktiv .video-area-eb4, .konferenz-live-aktiv .page-title-white { display: none !important; }

        /* NAVIGATION */
        .bottom-nav { display: flex; justify-content: space-between; width: 100%; padding: 10px 20px; position: fixed; bottom: 0; left: 0; box-sizing: border-box; background: #000; z-index: 100; border-top: 1px solid #333; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; border-radius: 5px; }
        .dot { width: 10px; height: 10px; background: #444; border-radius: 50%; }
        .dot.active { background: #ffd700; box-shadow: 0 0 10px #ffd700; }

        #counter-box { position: absolute; right: 0; top: 0; width: 100px; padding: 5px; border-left: 2px solid #003d8f; border-bottom: 2px solid #003d8f; background: #000; text-align: center; display: none; z-index: 100; }
        .counter-value { font-size: 0.85rem; font-weight: 900; color: #ff0000; }
        .top-container { width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 1vh; flex-shrink: 0; }
        .page-title-white { text-transform: uppercase; font-size: 1.8rem; margin-bottom: 5px; font-weight: 900; color: #fff; }
        
        .num-neutral { background-color: #003d8f !important; }
        .num-gelesen { background-color: #ffd700 !important; color: #000 !important; }
        .num-offen { background-color: #ff4d4d !important; }
        .num-fertig { background-color: #00ff00 !important; color: #000 !important; }

        .werbe-bild-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0; z-index: 1; }
        .bild-aktiv { animation: kenburns 20s infinite ease-in-out, fadeEffect 10s infinite; }
    </style>
</head>
<body>

    <div id="dashboard" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <div class="dashboard-header">
            <div class="logo-ring" ondblclick="adminUnlock()"><div class="logo-mm">M&M</div><div class="logo-community">COMMUNITY</div></div>
        </div>
        <div class="info-section" style="width: 80%; height: 26vh; border: 2px solid #003d8f; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #000; position: relative; overflow: hidden; margin-top: 10vh;">
            <h1 style="font-size: 2.8rem; margin: 0; font-weight: 900;">DAS WAS & WARUM</h1>
            <h2 style="color: #003d8f; font-size: 1.8rem; margin: 5px 0;">DIE STILLE MILLION</h2>
            <p style="max-width: 85%; color: #ccc; font-size: 1.1rem; margin: 10px 0 0 0; text-align: center;">
                Die M&M-Community ist das Fundament für alle. <strong>Die Wahl der Vorsitzenden erfolgt erst nach Erreichen der stillen Million.</strong>
            </p>
        </div>
        <div class="grid" id="main-grid"></div>
        <div class="fundament-container" style="display: flex; width: 95%; max-width: 1450px; gap: 10px; margin-top: 10px; margin-bottom: 10px;">
            <div class="fundament-box" style="flex: 1;"><div class="num">21</div><div class="text">Kapital und Verwaltung</div></div>
            <div class="fundament-box" style="flex: 1;"><div class="num">22</div><div class="text">DAS KOLLEKTIV</div></div>
        </div>
        <div class="zugang-container" style="display: flex; width: 95%; max-width: 1450px; gap: 10px; margin-bottom: 80px;">
            <div class="fundament-box" style="flex: 1; border-color: #555; cursor: pointer;" onclick="showZugangInfo('gast')">
                <div class="num" style="background-color: #333;">G</div>
                <div class="text">Gast-Zugang (Eingeschränkt)</div>
            </div>
            <div class="fundament-box" style="flex: 1; border-color: #8b00ff; cursor: pointer;" onclick="showZugangInfo('email')">
                <div class="num" style="background-color: #8b00ff;">V</div>
                <div class="text" style="color: #ffd700;">Verifizierter Status (Voller Zugriff 1-4)</div>
            </div>
        </div>
    </div>

    <div id="page-skelett" style="display: none; width: 100%; flex-direction: column; align-items: center; height: 100vh;">
        <div class="top-container" id="global-header-ebene">
            <h1 id="info-titel" class="page-title-white"></h1>
            <div class="tafel-layout">
                <div class="buttons-links">
                    <div class="oval-side ov-schwarz" id="sig-l1"></div>
                    <div class="oval-side ov-grun" id="sig-l2"></div>
                    <div class="oval-side ov-blau" id="sig-l3"></div>
                    <div class="oval-side ov-rot" id="sig-l4" onclick="portalZuEbene4()"></div>
                </div>
                <div class="info-section-ebene">
                    <div class="werbe-bild-bg" id="werbe-bg"></div>
                    <div id="counter-box"><span style="font-size:0.4rem; color:#fff; display:block;">STILLE MILLION</span><span class="counter-value">842.336</span></div>
                    <div id="platzhalter-werbung" style="z-index: 5; text-align: center; font-weight: bold; color: rgba(255,255,255,0.3); letter-spacing: 5px;">PLATZ FÜR WERBUNG</div>
                </div>
                <div class="buttons-rechts">
                    <div class="oval-side ov-grun" id="sig-r1"></div>
                    <div class="oval-side ov-blau" id="sig-r2"></div>
                    <div class="oval-side ov-pink" id="sig-r3"></div>
                    <div class="oval-side ov-gelb" id="sig-r4" onclick="portalZuEbene3()"></div>
                </div>
            </div>
        </div>

        <p id="main-text" style="width: 85%; text-align: justify; color: #ccc; margin-top: 2vh; font-size: 1.3rem; line-height: 1.8; max-height: 50vh; overflow-y: auto;"></p>

        <div id="chat-area">
            <div class="chat-msgs" id="chat-box"><i>System: Dialog bereit...</i></div>
            <div class="chat-input-row">
                <input type="text" id="chat-input" placeholder="Nachricht schreiben..." style="flex:1; background:transparent; border:none; color:#fff; padding:15px; outline:none;">
                <button style="background:#003d8f; color:#fff; border:none; padding:0 30px; font-weight:bold; cursor:pointer;">SENDEN</button>
            </div>
        </div> 

        <div id="drawer-ebene4">
            <div class="video-area-eb4" id="video-grid-eb4"></div>
            <button class="leiste-grun-freischalten" id="btn-konferenz-start" onclick="starteSektorKonferenz()">
                KONFERENZ FÜR SEKTOR [<span id="display-sektor-name"></span>] STARTEN
            </button>
            <div id="schublade-container-eb4" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
                <div class="sektor-leiste-aktiv" onclick="toggleEbene4Schublade()">
                    SEKTOR-LOGBUCH: <span id="display-sektor-titel"></span>
                </div>
                <div class="schublade-inhalt-eb4" id="schublade-eb4">
                    <textarea class="schublade-textarea" placeholder="Hier kannst du während der Konferenz schreiben, löschen und scrollen..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <button id="btn-back" class="nav-btn" style="visibility: hidden;" onclick="showDashboard()">← Dashboard</button>
        <div style="display: flex; gap: 8px; align-items: center;" id="dot-holder"></div>
        <button id="btn-next" class="nav-btn" style="visibility: hidden;" onclick="nextPage()">Weiter →</button>
    </div>

<script>
    let userBackstage = { isVerifiziert: false, geleseneThemen: new Set() };
    const themen = ["Recht auf Gefühls Forderung", "Wie werde ich Mensch", "Glaube an Friede", "Programm für Bürgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber für Pensionisten", "Sozialgefallen und Widerkehr", "Nachbarschaft und Gemeinschaft", "Mensch und Technik", "Die Brücke"];
    let ebene = 1, tId = 0, aktuellesThema = "", wechselInterval;

    const grid = document.getElementById('main-grid');
    themen.forEach((t, i) => { grid.innerHTML += `<div class="box" id="box-${i}"><div class="num num-neutral" id="num-${i}">${i+1}</div><div class="text" onclick="showInfo('${t}', ${i})">${t}</div></div>`; });

    const dots = document.getElementById('dot-holder');
    for(let i=1; i<=7; i++) dots.innerHTML += `<div id="dot${i}" class="dot ${i===1?'active':''}"></div>`;

    function showInfo(t, id) { 
        tId = id; aktuellesThema = t; 
        ebene = 2; userBackstage.geleseneThemen.add(id);
        document.getElementById('dashboard').style.display = 'none'; 
        document.getElementById('page-skelett').style.display = 'flex'; 
        updateUI(); 
    }

    function portalZuEbene3() { ebene = 3; updateUI(); }
    function portalZuEbene4() { 
        ebene = 4; 
        document.getElementById('display-sektor-name').innerText = aktuellesThema;
        document.getElementById('display-sektor-titel').innerText = aktuellesThema;
        updateUI(); 
    }

    function updateUI() {
        document.getElementById('chat-area').style.display = (ebene === 3) ? 'flex' : 'none';
        document.getElementById('drawer-ebene4').style.display = (ebene === 4) ? 'flex' : 'none';
        document.getElementById('main-text').style.display = (ebene === 2) ? 'block' : 'none';
        document.getElementById('btn-back').style.visibility = 'visible';
        document.getElementById('info-titel').innerText = (ebene === 4 && document.body.classList.contains('konferenz-live-aktiv')) ? "" : aktuellesThema;
        
        document.getElementById('sig-r4').classList.toggle('signal-aktiv', ebene === 2);
        document.getElementById('sig-l4').classList.toggle('signal-aktiv', ebene === 3);

        for(let i=1; i<=7; i++) {
            const d = document.getElementById('dot'+i);
            if(d) d.classList.toggle('active', i === ebene);
        }
    }

    function toggleEbene4Schublade() {
        const content = document.getElementById('schublade-eb4');
        content.style.display = (content.style.display === 'block') ? 'none' : 'block';
    }

    function showDashboard() { 
        ebene = 1; 
        document.body.classList.remove('konferenz-live-aktiv');
        document.getElementById('page-skelett').style.display = 'none'; 
        document.getElementById('dashboard').style.display = 'flex'; 
    }

    async function starteSektorKonferenz() {
        document.body.classList.add('konferenz-live-aktiv');
        const tafel = document.querySelector('.info-section-ebene');
        tafel.innerHTML = ''; 
        for(let i=1; i<=8; i++) {
            tafel.innerHTML += `<div id="live-v-${i}" style="background:#050505; border:1px solid #00ff00; display:flex; align-items:center; justify-content:center; font-size:0.5rem; color:#00ff00;">SLOT ${i}</div>`;
        }
        document.getElementById('schublade-eb4').style.display = 'block';
        document.getElementById('btn-konferenz-start').style.display = 'none';
        
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
            const s1 = document.getElementById('live-v-1');
            s1.innerHTML = `<video autoplay playsinline style="width:100%; height:100%; object-fit:cover;"></video>`;
            s1.querySelector('video').srcObject = stream;
        } catch(e) { console.log("Kamera-Fehler"); }
    }
</script>
</body>
</html>
