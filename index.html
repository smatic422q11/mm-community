<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>M&M-COMMUNITY - VOLLMECHANIK MASTER</title>
    <style>
        /* ALLE MECHANISCHEN STYLES AUS 10 SCHRITTEN */
        body { background-color: #000; color: #fff; font-family: 'Segoe UI', Arial; margin: 0; overflow: hidden; display: flex; flex-direction: column; align-items: center; }
        
        /* SIGNAL-KABEL & ANIMATIONEN */
        @keyframes signalBlink { 0% { box-shadow: 0 0 5px #fff; opacity: 0.8; } 50% { box-shadow: 0 0 25px #fff, 0 0 35px #003d8f; opacity: 1; transform: scale(1.05); } 100% { box-shadow: 0 0 5px #fff; opacity: 0.8; } }
        .signal-aktiv { animation: signalBlink 1.0s infinite ease-in-out !important; border: 2px solid #fff !important; cursor: pointer; }
        
        /* DAS GRID (MECHANIK AUS SCHRITT 5 & 10) */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); grid-auto-flow: column; gap: 10px; width: 95%; max-width: 1450px; margin-top: 20px; border: 3px solid #00ff00; padding: 15px; border-radius: 10px; }
        .box { display: flex; border: 2px solid #003d8f; background-color: #000; min-height: 58px; position: relative; overflow: hidden; }
        .num { width: 38px; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0; }
        .text { padding: 4px 8px; text-transform: uppercase; font-size: 0.6rem; display: flex; align-items: center; cursor: pointer; flex-grow: 1; }

        /* STATUS-FARBEN (DIE LOGIK-KABEL) */
        .num-neutral { background-color: #003d8f; }
        .num-gelesen { background-color: #ffd700; color: #000; }
        .num-offen { background-color: #ff4d4d; }
        .num-fertig { background-color: #00ff00; color: #000; }

        /* TAFEL-MECHANIK (AUS SCHRITT 7 & 8) */
        .tafel-layout { display: flex; align-items: center; justify-content: center; width: 100%; position: relative; height: 26vh; margin-top: 2vh; }
        .info-section-ebene { width: 90%; height: 100%; border: 2px solid #003d8f; background-color: #000; position: relative; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        .oval-side { width: 45px; height: 22px; border-radius: 12px; border: 1px solid #fff; opacity: 0.8; margin: 5px 0; }
        .ov-schwarz { background: #000; border: 1.5px solid #003d8f; }
        .ov-rot { background: #ff0000; } .ov-gelb { background: #ffff00; }

        /* SCHUBLADEN & CHAT (AUS SCHRITT 9) */
        .chat-area { width: 90%; height: 45vh; display: none; flex-direction: column; }
        .chat-msgs { flex: 1; overflow-y: auto; padding: 10px; border: 1px solid #003d8f; margin-bottom: 5px; }
        .schublade { border: 1px solid #003d8f; margin-bottom: 5px; background: #050505; width: 90%; }
        .schublade-header { padding: 10px; cursor: pointer; background: #001a3d; display: flex; justify-content: space-between; }
        .schublade-content { max-height: 0; overflow: hidden; transition: max-height 0.5s; padding: 0 10px; }
        .schublade.open .schublade-content { max-height: 300px; padding: 10px; }

        /* NAVIGATION */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 60px; background: #000; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; border-top: 1px solid #333; box-sizing: border-box; }
        .nav-btn { background: #ffd700; color: #000; border: none; padding: 8px 15px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <div id="dashboard" style="width:100%; display:flex; flex-direction:column; align-items:center;">
        <div class="logo-ring" style="width:100px; height:100px; border:2px solid #fff; border-radius:50%; background:#003d8f; margin-top:20px; display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer;" ondblclick="adminUnlock()">
            <div style="font-weight:900; font-size:1.5rem;">M&M</div>
            <div style="font-size:0.5rem;">COMMUNITY</div>
        </div>
        <div class="grid" id="main-grid"></div>
        <div style="width:95%; display:flex; gap:10px; margin-top:10px;">
            <div class="box" style="flex:1; border-color:#fff;" onclick="access('gast')"><div class="num" style="background:#333">G</div><div class="text">Gast-Zugang</div></div>
            <div class="box" style="flex:1; border-color:#8b00ff;" onclick="access('verify')"><div class="num" style="background:#8b00ff">V</div><div class="text">Verifiziert</div></div>
        </div>
    </div>

    <div id="skelett" style="display:none; width:100%; flex-direction:column; align-items:center;">
        <h1 id="titel" style="text-transform:uppercase;">Sektor</h1>
        <div class="tafel-layout">
            <div style="position:absolute; left:2%; display:flex; flex-direction:column;">
                <div class="oval-side ov-schwarz" id="sig-l1"></div>
                <div class="oval-side ov-rot" id="sig-rot" onclick="portal(4)"></div>
            </div>
            <div class="info-section-ebene">
                <div style="color:rgba(255,255,255,0.1); font-size:2rem; font-weight:900;">MECHANIK AKTIV</div>
            </div>
            <div style="position:absolute; right:2%;">
                <div class="oval-side ov-gelb" id="sig-gelb" onclick="portal(3)"></div>
            </div>
        </div>

        <div id="text-ebene2" style="width:85%; padding:20px; text-align:justify; height:40vh; overflow-y:auto;"></div>

        <div id="chat-ebene3" class="chat-area">
            <div class="chat-msgs" id="chat-box"></div>
            <div style="display:flex;"><input type="text" id="chat-in" style="flex:1; padding:10px;"><button onclick="send()">OK</button></div>
        </div>

        <div id="doks-ebene4" style="display:none; width:100%; flex-direction:column; align-items:center;"></div>

        <div class="bottom-nav">
            <button class="nav-btn" onclick="goDash()">DASHBOARD</button>
            <button class="nav-btn" onclick="next()">NÄCHSTER</button>
        </div>
    </div>

    <script>
        /* ALLE MECHANISCHEN KABEL (DIE LOGIK) */
        const themen = ["Recht auf Gefühls Forderung", "Wie werde ich Mensch", "Glaube an Friede", "Programm für Bürgerliche Rechte", "Moralische Pflicht und Verantwortung", "Menschlichkeit Wiederherstellung", "Kinderschutz-Pflicht-Elternrechte", "Wahre Richtung und Kunst", "LGBTQ und Kirche", "Trend and Tradition", "Religionsbekenntnis oder Selbstwahl", "Gesundheitswesen und Verhalten", "Arbeitswelt und Du", "Mobbing am Arbeitsplatz", "Jugendsprecher", "Ratgeber für Pensionisten", "Sozialgefallen und Widerkehr", "Nachbarschaft und Gemeinschaft", "Mensch und Technik", "Die Brücke"];
        let ebene = 1, tId = 0, hasAccess = false, gelesene = new Set(), interaktionen = {}, chats = {};

        // Aufbau der Mechanik
        themen.forEach((t, i) => {
            interaktionen[i] = 0;
            chats[i] = "";
            document.getElementById('main-grid').innerHTML += `<div class="box"><div class="num num-neutral" id="num-${i}">${i+1}</div><div class="text" onclick="openSek(${i})">${t}</div></div>`;
            document.getElementById('doks-ebene4').innerHTML += `<div class="schublade" id="dr-${i}"><div class="schublade-header" onclick="this.parentElement.classList.toggle('open')">${t}<span>▼</span></div><div class="schublade-content"><textarea style="width:100%; height:100px;"></textarea></div></div>`;
        });

        function access(t) { hasAccess = true; alert("Zugang: " + t); }

        function openSek(i) {
            if(!hasAccess) return alert("Zugang wählen!");
            if(i > 0 && !gelesene.has(i-1)) return alert("Reihenfolge!");
            tId = i; ebene = 2; gelesene.add(i);
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('skelett').style.display = 'flex';
            update();
        }

        function update() {
            document.getElementById('titel').innerText = themen[tId];
            document.getElementById('text-ebene2').style.display = (ebene==2)?'block':'none';
            document.getElementById('chat-ebene3').style.display = (ebene==3)?'flex':'none';
            document.getElementById('doks-ebene4').style.display = (ebene==4)?'flex':'none';
            document.getElementById('text-ebene2').innerText = "Inhalt Sektor " + (tId+1);
            document.getElementById('chat-box').innerHTML = chats[tId];
            
            // Die Kabel-Logik für Portale
            const alleGelesen = gelesene.size === 20;
            const alleChat = Object.values(interaktionen).every(v => v >= 20);
            document.getElementById('sig-gelb').className = "oval-side ov-gelb " + (alleGelesen ? "signal-aktiv" : "");
            document.getElementById('sig-rot').className = "oval-side ov-rot " + (alleChat ? "signal-aktiv" : "");
            
            themen.forEach((_, i) => {
                const n = document.getElementById('num-'+i);
                if(interaktionen[i]>=20) n.className="num num-fertig";
                else if(interaktionen[i]>0) n.className="num num-offen";
                else if(gelesene.has(i)) n.className="num num-gelesen";
            });
        }

        function send() {
            const val = document.getElementById('chat-in').value;
            if(!val) return;
            chats[tId] += `<div>${val}</div>`;
            if(interaktionen[tId] < 20) interaktionen[tId]++;
            document.getElementById('chat-in').value = "";
            update();
        }

        function portal(e) { 
            if(e===3 && gelesene.size===20) ebene=3; 
            else if(e===4 && Object.values(interaktionen).every(v=>v>=20)) ebene=4;
            else return alert("Gesperrt!");
            update();
        }

        function goDash() { document.getElementById('skelett').style.display='none'; document.getElementById('dashboard').style.display='flex'; update(); }
        function next() { if(tId < 19) { tId++; gelesene.add(tId); update(); } }
        function adminUnlock() { hasAccess=true; gelesene=new Set(themen.keys()); themen.forEach((_,i)=>interaktionen[i]=20); update(); }
    </script>
</body>
</html>
